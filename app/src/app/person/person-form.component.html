<div class="person-form">
  <div class="person-form__header">
    <h1 class="person-form__title">
      <mat-icon class="person-form__icon">
        {{ isEdit() ? 'edit' : 'person_add' }}
      </mat-icon>
      {{ isEdit() ? 'Editar' : 'Nova' }} Pessoa
    </h1>
  </div>

  <mat-card appearance="outlined">
    @if (loading()) {
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    }
    
    <mat-card-content>
      <form [formGroup]="form" (ngSubmit)="onSubmit()" class="person-form__form">
        <mat-form-field appearance="outline" class="person-form__field">
          <mat-label>Nome completo</mat-label>
          <input
            matInput
            formControlName="name"
            placeholder="Digite o nome completo"
            maxlength="120"
            required
            autocomplete="off"
          />
          <mat-icon matPrefix>person</mat-icon>
          <mat-hint align="end">{{ form.get('name')?.value?.length || 0 }}/120</mat-hint>
          @if (form.get('name')?.touched && form.get('name')?.invalid) {
            <mat-error>{{ getErrorMessage('name') }}</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline" class="person-form__field">
          <mat-label>E-mail</mat-label>
          <input
            matInput
            type="email"
            formControlName="email"
            placeholder="exemplo@email.com"
            maxlength="180"
            required
            autocomplete="off"
          />
          <mat-icon matPrefix>email</mat-icon>
          <mat-hint align="end">{{ form.get('email')?.value?.length || 0 }}/180</mat-hint>
          @if (form.get('email')?.touched && form.get('email')?.invalid) {
            <mat-error>{{ getErrorMessage('email') }}</mat-error>
          }
        </mat-form-field>

        <div class="person-form__actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="saving() || loading()"
          >
            <mat-icon>{{ saving() ? 'hourglass_empty' : 'save' }}</mat-icon>
            {{ saving() ? 'Salvando...' : 'Salvar' }}
          </button>
          <a
            mat-stroked-button
            routerLink="/persons"
            [disabled]="saving()"
          >
            <mat-icon>cancel</mat-icon>
            Cancelar
          </a>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <div class="person-form__help">
    <mat-icon>info</mat-icon>
    <p>Preencha todos os campos obrigat√≥rios para continuar.</p>
  </div>
</div>
